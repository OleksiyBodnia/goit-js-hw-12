{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from 'axios';\n\n\nconst listOfPhotos = document.querySelector('.container ul');\nconst loader = document.querySelector('.loader');\nconst form = document.querySelector('.form');\nconst input = document.querySelector('input');\n\nconst loadMoreBtn = document.createElement('button');\nloadMoreBtn.textContent = \"Load more\"\nloadMoreBtn.style.margin = \"0 auto\";\nloadMoreBtn.style.marginTop = \"15px\";\nloadMoreBtn.style.width = \"150px\";\nloader.after(loadMoreBtn);\nloadMoreBtn.style.display = 'none';\n\nlet inputValue = '';\nlet page = 1;\nconst perPage = 15;\n\nconst searchDefaultParam = {\n    key: '42291336-b4c9ef387c9d7e209159058e7',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n}\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nconst getTotalHits = async () => {\n    try{\n        const response = await axios.get('?', {\n            params: {\n                q: inputValue,\n                ...searchDefaultParam,\n                page: 1,\n                per_page: perPage,\n            }\n        });\n        return response.data.totalHits;\n    } catch (error){\n        console.log(error);\n        return 0;\n    }\n}\n\nconst totalHits = getTotalHits();\nlet totalPages = Math.ceil(totalHits/perPage);\n\nform.addEventListener('submit', async (event) => {\n    event.preventDefault();\n    page = 1;\n    listOfPhotos.innerHTML = '';\n    inputValue = input.value.trim();\n\n    if (!inputValue){\n        iziToast.error({\n            title: 'Error',\n            message: 'Please enter a search term',\n            position: 'topRight'\n        });\n    } else {\n        loader.style.display = 'block';\n        loadMoreBtn.style.display = 'none';\n\n        try {\n            const response = await axios.get(`?`, {\n                params: {\n                    q: inputValue,\n                    ...searchDefaultParam,\n                    page: page,\n                    per_page: perPage\n                }\n            })\n            if (!response.data.hits || response.data.hits.length === 0) {\n                iziToast.error({\n                    message: 'Sorry, there are no images matching your search query. Please try again!',\n                    position: \"topRight\",\n                    icon: \"\"\n                });\n            } else {\n                renderingPhotos(response.data.hits);\n                loadMoreBtn.style.display = 'block';\n            }\n\n            loader.style.display = 'none';\n        } catch (error) {\n            loader.style.display = 'none';\n            loadMoreBtn.style.display = 'none';\n            console.log(error);\n        }\n    }\n\n    form.reset();\n});\n\nconst renderingPhotos = data => {\n    data.forEach(element => {\n\n        const murkup = `<li class=\"photo\">\n            <a href=\"${element.largeImageURL}\" data-lightbox=\"photos\">\n                <img src=\"${element.webformatURL}\" alt=\"${element.tags}\" title=\"${element.tags}\" class=\"img\">\n            </a>\n            <ul class=\"list\">\n                <li class=\"item\"><h2>Likes <span>${element.likes}</span></h2></li>\n                <li class=\"item\"><h2>Views <span>${element.views}</span></h2></li>\n                <li class=\"item\"><h2>Comments <span>${element.comments}</span></h2></li>\n                <li class=\"item\"><h2>Downloads <span>${element.downloads}</span></h2></li>\n            </ul>\n        </li>`;\n\n        listOfPhotos.insertAdjacentHTML('beforeend', murkup);\n\n    });\n\n    const lightbox = new SimpleLightbox('.photos a', {});\n\n    lightbox.refresh();\n}\n\nloadMoreBtn.addEventListener('click', async (event) => {\n    loader.style.display = 'block';\n\n    try {\n        page++;\n        const response = await axios.get(`?`, {\n            params: {\n                q: inputValue,\n                ...searchDefaultParam,\n                page: page,\n                per_page: perPage\n            }\n        });\n        loader.style.display = 'none';\n        renderingPhotos(response.data.hits);\n        const cardHeight = listOfPhotos.firstElementChild.getBoundingClientRect().height;\n        \n        window.scrollBy({\n            top: cardHeight * 3, \n            behavior: 'smooth'\n        });\n\n        const newTotalHits = response.data.totalHits;\n        totalPages = Math.ceil(newTotalHits / perPage);\n\n        if (page >= totalPages) {\n            loadMoreBtn.style.display = 'none';\n            iziToast.error({\n                position: \"topRight\",\n                message: \"We're sorry, but you've reached the end of search results.\"\n            });\n        }\n    } catch (error) {\n        loader.style.display = 'none';\n        console.log(error);\n    }\n});\n\n\n\n\n"],"names":["listOfPhotos","loader","form","input","loadMoreBtn","inputValue","page","perPage","searchDefaultParam","axios","getTotalHits","error","totalHits","totalPages","event","iziToast","response","renderingPhotos","data","element","murkup","SimpleLightbox","cardHeight","newTotalHits"],"mappings":"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"}